<!DOCTYPE html>
<html>
<head>
    <title>EventHub Diagnostic</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        pre { background: #f4f4f4; padding: 10px; }
    </style>
</head>
<body>
    <h1>EventHub Frontend Diagnostic</h1>
    <div id="output"></div>
    
    <script>
        const output = document.getElementById('output');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = message;
            output.appendChild(div);
        }
        
        async function runDiagnostics() {
            log('<h2>1. Environment Check</h2>');
            log(`Current URL: ${window.location.href}`);
            log(`Environment: ${import.meta?.env?.MODE || 'production'}`);
            
            log('<h2>2. LocalStorage Check</h2>');
            const token = localStorage.getItem('auth_token');
            const refreshToken = localStorage.getItem('refresh_token');
            log(`auth_token: ${token ? 'EXISTS (length: ' + token.length + ')' : 'NOT FOUND'}`, token ? 'error' : 'success');
            log(`refresh_token: ${refreshToken ? 'EXISTS' : 'NOT FOUND'}`, refreshToken ? 'error' : 'success');
            
            if (token || refreshToken) {
                log('<strong>⚠️ OLD TOKENS FOUND - Clear them!</strong>', 'error');
                log('<button onclick="localStorage.clear(); location.reload()">Clear LocalStorage & Reload</button>');
            }
            
            log('<h2>3. API Test - Public Endpoint</h2>');
            try {
                const apiUrl = 'https://eventuiapp.com/api/events?limit=1';
                log(`Testing: ${apiUrl}`);
                const response = await fetch(apiUrl);
                log(`Response Status: ${response.status} ${response.statusText}`, response.ok ? 'success' : 'error');
                
                if (response.ok) {
                    const data = await response.json();
                    log(`Response Data: <pre>${JSON.stringify(data, null, 2).substring(0, 500)}...</pre>`, 'success');
                } else {
                    const text = await response.text();
                    log(`Error Response: <pre>${text.substring(0, 500)}</pre>`, 'error');
                }
            } catch (error) {
                log(`API Error: ${error.message}`, 'error');
            }
            
            log('<h2>4. React Router Check</h2>');
            log(`Current Path: ${window.location.pathname}`);
            log(`Expected: Should show HomePage for "/"`, 'info');
            
            log('<h2>5. Build Info</h2>');
            const scripts = Array.from(document.querySelectorAll('script[src]'));
            log(`Loaded Scripts: ${scripts.length}`);
            scripts.slice(0, 3).forEach(s => log(`- ${s.src}`));
        }
        
        runDiagnostics();
    </script>
</body>
</html>
